# Netlify redirects for unified React blog architecture
#
# BLOG ROUTING ARCHITECTURE (Static-first with SPA fallback):
# ================================================================================
# This architecture serves the pre-rendered static HTML for every blog request,
# regardless of user agent, while keeping the React SPA available for the rest of
# the application.
#
# ARCHITECTURE PRINCIPLES:
# 1. Blog routes are always resolved to their generated index.html files
# 2. No user-agent checks are required—browsers and crawlers see the same HTML
# 3. The SPA catch-all only applies after every static blog permutation is handled
# 4. Keep the SPA only for non-blog paths; blog pages remain static
#
# RESULTING FLOW:
# - Any request to /blog/... or /<lang>/blog/... → static HTML at the matching
#   /blog/.../index.html file
# - All other routes → React SPA via the catch-all rule below
#
# TESTING:
# Test crawler access:
#   curl -A "Googlebot" https://veridaq.com/blog/post-slug
# Test browser access:
#   curl -A "Mozilla/5.0" https://veridaq.com/blog/post-slug
#
# ================================================================================

# ================================================================================
# BLOG ROUTES - Serve static HTML for every request
# ================================================================================
# These unconditional rewrites ensure both crawlers and browsers receive the
# generated HTML instead of falling back to the SPA. Order matters—keep these
# before the crawler-specific sitemap handling, language catch-alls, and the
# global SPA fallback.

# English blog routes
/blog                           /blog/index.html                200
/blog/*                         /blog/:splat/index.html         200

# Danish blog routes
/da/blog                        /da/blog/index.html             200
/da/blog/*                      /da/blog/:splat/index.html      200

# Swedish blog routes
/sv/blog                        /sv/blog/index.html             200
/sv/blog/*                      /sv/blog/:splat/index.html      200

# Norwegian blog routes
/no/blog                        /no/blog/index.html             200
/no/blog/*                      /no/blog/:splat/index.html      200

# Finnish blog routes
/fi/blog                        /fi/blog/index.html             200
/fi/blog/*                      /fi/blog/:splat/index.html      200

# German blog routes
/de/blog                        /de/blog/index.html             200
/de/blog/*                      /de/blog/:splat/index.html      200

# French blog routes
/fr/blog                        /fr/blog/index.html             200
/fr/blog/*                      /fr/blog/:splat/index.html      200

# Spanish blog routes
/es/blog                        /es/blog/index.html             200
/es/blog/*                      /es/blog/:splat/index.html      200

# Italian blog routes
/it/blog                        /it/blog/index.html             200
/it/blog/*                      /it/blog/:splat/index.html      200

# Portuguese blog routes
/pt/blog                        /pt/blog/index.html             200
/pt/blog/*                      /pt/blog/:splat/index.html      200

# Dutch blog routes
/nl/blog                        /nl/blog/index.html             200
/nl/blog/*                      /nl/blog/:splat/index.html      200

# ================================================================================
# NOTE: With the universal blog rewrites above, the SPA catch-all applies only
# to non-blog routes. Static HTML remains the source of truth for blog content.
# ===============================================================================

# ================================================================================
# SITEMAP & CRAWLER FILES (Multi-method discovery)
# ================================================================================
# Primary sitemap endpoints - serve actual XML files
/robots.txt                     /robots.txt                     200
/sitemap.xml                    /sitemap.xml                    200
/sitemap-*.xml                  /sitemap-:splat.xml             200

# AI plugin discovery (OpenAI, Perplexity, etc.)
/.well-known/ai-plugin.json     /.well-known/ai-plugin.json     200
/ai-plugin.json                 /.well-known/ai-plugin.json     200

# Sitemap aliases - normalize common alternative URLs to main sitemap
# These handle crawlers that probe standard sitemap locations
/sitemap_index.xml              /sitemap.xml                    301
/sitemap.xml.gz                 /sitemap.xml                    200
/sitemapindex.xml               /sitemap.xml                    301
/blog/sitemap.xml               /sitemap.xml                    301
/blog/sitemap-*.xml             /sitemap-:splat.xml             301
/blog/sitemap_index.xml         /sitemap.xml                    301

# Return 404 for nonsense sitemap paths instead of SPA fallback
/_sitemap/*                     /404.html                       404
/wp-sitemap.xml                 /404.html                       404
/sitemap-misc.xml               /404.html                       404

# CMS routes (always handled by React)
/cms/*                          /index.html                     200

# Legacy URL redirects for old translation URL patterns
# Redirect old suffixed URLs to language-specific paths
/blog/*-danish                  /da/blog/:splat                 301
/blog/*-norwegian               /no/blog/:splat                 301
/blog/*-swedish                 /sv/blog/:splat                 301
/blog/*-german                  /de/blog/:splat                 301
/blog/*-french                  /fr/blog/:splat                 301
/blog/*-finnish                 /fi/blog/:splat                 301
/blog/*-italian                 /it/blog/:splat                 301
/blog/*-spanish                 /es/blog/:splat                 301
/blog/*-portuguese              /pt/blog/:splat                 301
/blog/*-dutch                   /nl/blog/:splat                 301

# ================================================================================
# LANGUAGE-SPECIFIC ROUTES (Non-blog pages)
# ================================================================================
# Homepage and other pages in different languages

/da/*                           /index.html                     200
/sv/*                           /index.html                     200
/no/*                           /index.html                     200
/fi/*                           /index.html                     200
/de/*                           /index.html                     200
/fr/*                           /index.html                     200
/es/*                           /index.html                     200
/it/*                           /index.html                     200
/pt/*                           /index.html                     200
/nl/*                           /index.html                     200

# ================================================================================
# FALLBACK - Main site catch-all
# ================================================================================
# Catch any unmatched routes and serve React SPA

/*                              /index.html                     200
