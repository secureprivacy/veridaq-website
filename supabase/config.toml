# Supabase Configuration for Magic Link Authentication

[auth]
# Enable email authentication
enable_signup = false   # Disable public signups for security
enable_email_confirmations = false  # Disable email confirmations for magic links
enable_email_autoconfirm = true  # Auto-confirm authorized emails
enable_anonymous_signups = false  # Disable anonymous access

# Magic link specific settings
external_email_enabled = true
external_phone_enabled = false
mailer_urlpaths_confirmation = "/auth/v1/verify"
mailer_urlpaths_invite = "/auth/v1/verify"
mailer_urlpaths_recovery = "/auth/v1/verify"
mailer_urlpaths_email_change = "/auth/v1/verify"

# Magic link settings
mailer_autoconfirm = true
mailer_secure_email_change_enabled = true
mailer_otp_exp = 900  # 15 minutes (900 seconds)

# Disable password requirements for magic links
password_min_length = 0
enable_confirmations = false

# Rate limiting
rate_limit_email_sent = 60  # 1 per minute
rate_limit_sms_sent = 60   # 1 per minute

# Session settings
jwt_exp = 3600  # 1 hour
refresh_token_rotation_enabled = true
security_refresh_token_reuse_interval = 10

# CORS settings for production
[auth.external.cors]
allowed_origins = ["https://veridaq.com", "https://kyc-aml-solution-web-k2fj.bolt.host", "http://localhost:5173"]
allowed_headers = ["Content-Type", "Authorization", "X-Requested-With"]
allowed_methods = ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
allow_credentials = true

# Email template customization
[auth.email.template.magic_link]
subject = "Secure CMS Access - Veridaq"
content_path = "./supabase/templates/magic_link.html"

[auth.email.template.email]
subject = "Your CMS Access Code - Veridaq"
content_path = "./supabase/templates/otp_code.html"

[auth.email.template.recovery]
subject = "CMS Account Recovery - Veridaq"
content_path = "./supabase/templates/recovery.html"

# Security settings
[auth.security]
captcha_enabled = false  # Can be enabled for additional security
password_min_length = 8
refresh_token_reuse_interval = 10

# Database settings
[db]
pool_size = 15
max_client_conn = 100
default_pool_size = 15